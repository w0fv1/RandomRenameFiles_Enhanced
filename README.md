### **文件随机重命名脚本**

**脚本名称**：`RandomRenameFiles_Enhanced.ps1`

**功能概述**：
该 PowerShell 脚本旨在简化文件管理任务，通过将指定目录下的所有文件随机重命名为由随机字符串组成的新名称，同时保留原有的文件扩展名。这不仅有助于保护文件的隐私，还能有效防止文件名冲突或泄露敏感信息。

**主要特点**：

1. **图形化文件夹选择**：
   - 通过直观的文件夹选择对话框，用户无需手动输入路径，即可轻松指定目标文件夹。

2. **自定义随机字符串长度**：
   - 用户可以根据需求输入随机字符串的长度，默认为8个字符，确保灵活性和适用性。

3. **保留文件扩展名**：
   - 无论文件类型如何，脚本都会保留原有的扩展名（如 `.txt`, `.jpg`），确保文件在重命名后依然可正常使用。

4. **避免命名冲突**：
   - 脚本内置机制，确保生成的随机文件名在目标目录中唯一，避免因重名导致的覆盖或错误。

5. **用户友好提示**：
   - 在脚本运行过程中，提供清晰的提示信息，引导用户完成操作，并显示重命名进度及结果。

**使用场景**：

- **隐私保护**：在分享文件之前，快速隐藏原有文件名，保护文件内容隐私。
- **批量重命名**：高效处理大量文件的重命名需求，节省手动操作时间。
- **数据整理**：在整理和归档文件时，通过统一的随机命名规则，提升文件管理的规范性。

**使用步骤**：

1. **运行脚本**：双击或在 PowerShell 中执行 `RandomRenameFiles_Enhanced.ps1`。
2. **选择目标文件夹**：在弹出的对话框中，浏览并选择需要重命名的文件夹。
3. **输入字符串长度**：根据需求输入随机字符串的长度，或直接按回车使用默认值。
4. **完成重命名**：脚本自动处理所有文件，完成后会显示重命名结果。

**注意事项**：

1. **备份重要文件**：
   - 在批量重命名前，建议备份目标文件夹中的重要文件，以防意外情况发生。

2. **权限要求**：
   - 确保当前用户对目标文件夹及其内容具有重命名权限。如果没有适当的权限，脚本将无法重命名文件。

3. **处理无法运行 `.ps1` 脚本的情况**：
   - **问题描述**：有时由于系统的执行策略限制，可能无法直接运行 PowerShell 脚本，导致脚本无法执行。
   - **解决方案**：
     - **临时更改执行策略**：
       1. **打开 PowerShell**：
          - 按 `Win + X`，选择 **Windows PowerShell** 或 **Windows PowerShell (管理员)**。
       2. **允许脚本运行**：
          - 执行以下命令以临时允许当前 PowerShell 会话运行脚本：
            ```powershell
            Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
            ```
          - 这不会更改系统的全局执行策略，仅对当前会话有效。
       3. **运行脚本**：
          - 导航到脚本所在目录并运行脚本：
            ```powershell
            cd "C:\路径\到\脚本所在的文件夹"
            .\RandomRenameFiles_Enhanced.ps1
            ```
     - **永久更改执行策略**（不推荐，除非必要）：
       - 如果您经常需要运行 PowerShell 脚本，可以考虑永久更改执行策略：
         1. **打开 PowerShell（管理员）**。
         2. **执行以下命令**：
            ```powershell
            Set-ExecutionPolicy RemoteSigned
            ```
         3. **确认更改**：
            - 输入 `Y` 并按回车确认更改。
       - **注意**：更改执行策略可能带来安全风险，请确保仅从可信来源运行脚本。

     - **绕过执行策略运行脚本**：
       - 您也可以在运行脚本时使用 `-ExecutionPolicy Bypass` 参数：
         ```powershell
         PowerShell.exe -ExecutionPolicy Bypass -File "C:\路径\到\脚本\RandomRenameFiles_Enhanced.ps1"
         ```
       - 这将仅对该次执行有效，不会更改全局执行策略。

4. **文件扩展名**：
   - 脚本会保留文件的原始扩展名。如果文件没有扩展名，新的文件名也不会包含扩展名。

5. **执行策略安全性**：
   - 虽然临时更改执行策略可以解决脚本无法运行的问题，但请谨慎操作，仅在信任的脚本和环境中使用，避免潜在的安全风险。

---

通过使用 `RandomRenameFiles_Enhanced.ps1`，用户可以轻松、高效地管理和保护文件，提升工作效率和数据安全性。如果有任何疑问或需要进一步的功能扩展，欢迎随时联系！
